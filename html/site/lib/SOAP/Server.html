<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>SOAP::Server - provides the basic framework for the transport-specific server classes to build upon</title>
<link rel="stylesheet" href="../../../Active.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:root@localhost" />
</head>

<body>
<table border="0" width="100%" cellspacing="0" cellpadding="3">
<tr><td class="block" valign="middle">
<big><strong><span class="block">&nbsp;SOAP::Server - provides the basic framework for the transport-specific server classes to build upon</span></strong></big>
</td></tr>
</table>

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<li><a href="#methods">METHODS</a></li>
	<ul>

		<li><a href="#soap__server__parameters">SOAP::Server::Parameters</a></li>
		<ul>

			<li><a href="#example">EXAMPLE</a></li>
		</ul>

	</ul>

	<li><a href="#see_also">SEE ALSO</a></li>
	<li><a href="#acknowledgements">ACKNOWLEDGEMENTS</a></li>
	<li><a href="#copyright">COPYRIGHT</a></li>
	<li><a href="#authors">AUTHORS</a></li>
</ul>
<!-- INDEX END -->

<hr />
<p>
</p>
<hr />
<h1><a name="name">NAME</a></h1>
<p>SOAP::Server - provides the basic framework for the transport-specific server classes to build upon</p>
<p>
</p>
<hr />
<h1><a name="description">DESCRIPTION</a></h1>
<p>The SOAP::Server class provides the basic framework for the transport-specific server classes to build upon. Note that in none of the code examples provided with SOAP::Lite is this class used directly. Instead, it is designed to be a superclass within more specific implementation classes. The methods provided by SOAP::Server itself are:</p>
<p>
</p>
<hr />
<h1><a name="methods">METHODS</a></h1>
<dl>
<dt><strong><a name="item_new">new(optional key/value pairs)</a></strong>

<dd>
<pre>
    $server = SOAP::Server-&gt;new(%options);</pre>
</dd>
<dd>
<p>Creates a new object of the class. Various default instance values are set up, and like many of the constructors in this module, most of the class methods described here may be passed in the construction call by giving the name followed by the parameter (or an array reference if there are multiple parameters).</p>
</dd>
<dt><strong><a name="item_action">action(optional new value)</a></strong>

<dd>
<pre>
    $action = $server-&gt;action</pre>
</dd>
<dd>
<p>Retrieves or sets the value of the action attribute on the server object. This attribute is used when mapping the request to an appropriate namespace or routine. For example, the HTTP library sets the attribute to the value of the SOAPAction header when processing of the request begins, so that the find_target method described later may retrieve the value to match it against the server's configuration. Returns the object itself when setting the attribute.</p>
</dd>
<dt><strong><a name="item_myuri">myuri(optional new value)</a></strong>

<dd>
<pre>
    $server-&gt;myuri(&quot;<a href="http://localhost:9000/SOAP&quot">http://localhost:9000/SOAP&quot</a>;);</pre>
</dd>
<dd>
<p>Gets or sets the myuri attribute. This specifies the specific URI that the server is answering requests to (which may be different from the value specified in action or in the SOAPAction header).</p>
</dd>
<dt><strong><a name="item_serializer">serializer(optional new value)</a></strong>

<dt><strong><a name="item_deserializer">deserializer(optional new value)</a></strong>

<dd>
<pre>
    $serializer = $server-&gt;serializer;
    $server-&gt;deserializer($new_deser_obj);</pre>
</dd>
<dd>
<p>As with the client objects, these methods provide direct access to the serialization and deserialization objects the server object uses to transform input and output from and to XML. There is generally little or no need to explicitly set these to new values.</p>
</dd>
<dt><strong><a name="item_options">options(optional new value)</a></strong>

<dd>
<pre>
    $server-&gt;options({compress_threshold =&gt; 10000});</pre>
</dd>
<dd>
<p>Sets (or retrieves) the current server options as a hash-table  reference. At present, only one option is used within the SOAP::Lite libraries themselves:</p>
</dd>
<dl>
<dt><strong><a name="item_compress_threshold">compress_threshold</a></strong>

<dd>
<p>The value of this option is expected to be a numerical value. If set, and if the Compress::Zlib library is available to use, messages whose size in bytes exceeds this value are compressed for transmission. Both
ends of the conversation have to support this and have it enabled.</p>
</dd>
</li>
</dl>
<p>Other options may be defined and passed around using this mechanism. Note that setting the options using this accessor requires a full hash reference be passed. To set just one or a few values, retrieve the current reference value and use it to set the key(s).</p>
<dt><strong><a name="item_dispatch_with">dispatch_with(optional new value)</a></strong>

<dd>
<pre>
    $server-&gt;dispatch_with($new_table);</pre>
</dd>
<dd>
<p>Represents one of two ways in which a SOAP::Server (or derived) object may specify mappings of incoming requests to server-side subroutines or namespaces. The value of the attribute is a hash-table reference. To set the attribute, you must pass a new hash reference. The hash table's keys are URI strings (literal URIs or the potential values of the SOAPAction header), and the corresponding values are one of a class name or an object reference. Requests that come in for a URI found in the table are routed to the specified class or through the specified object.</p>
</dd>
<dt><strong><a name="item_dispatch_to">dispatch_to(optional list of new values)</a></strong>

<dd>
<pre>
    $server-&gt;dispatch_to($dir, 'Module', 'Mod::meth');</pre>
</dd>
<dd>
<p>This is the more traditional way to specify modules and packages for routing requests. This is also an accessor, but it returns a list of values when called with no arguments (rather than a single one). Each item in the list of values passed to this method is expected to be one of four things:</p>
</dd>
<dl>
<dt><strong><a name="item_directory_path"><em>Directory path</em></a></strong>

<dd>
<p>If the value is a directory path, all modules located in that path are available for remote use.</p>
</dd>
</li>
<dt><strong><a name="item_package_name"><em>Package name</em></a></strong>

<dd>
<p>When the value is a package name (without including a specific method name), all routines within the package are available remotely.</p>
</dd>
</li>
<dt><strong><a name="item_fully_qualified_method_name"><em>Fully qualified method name</em></a></strong>

<dd>
<p>Alternately, when the value is a package-qualified name of a subroutine or method, that specific routine is made available. This allows the server to make selected methods available without opening the entire package.</p>
</dd>
</li>
<dt><strong><a name="item_object_reference"><em>Object reference</em></a></strong>

<dd>
<p>If the value is an object reference, the object itself routes the request.</p>
</dd>
<dd>
<p>The list of values held by the dispatch_to table are compared only after the URI mapping table from the dispatch_with attribute has been consulted. If the request's URI or SOAPAction header don't map to a specific configuration, the path specified by the action header (or in absence, the URI) is converted to a package name and compared against this set of values.</p>
</dd>
</li>
</dl>
<dt><strong><a name="item_objects_by_reference">objects_by_reference(optional list of new values)</a></strong>

<dd>
<pre>
    $server-&gt;objects_by_reference(qw(My:: Class));</pre>
</dd>
<dd>
<p>This also returns a list of values when retrieving the current attribute value,
as opposed to a single value.</p>
</dd>
<dd>
<p>This method doesn't directly specify classes for request routing so much as it
modifies the behavior of the routing for the specified classes. The classes that
are given as arguments to this method are marked to be treated as producing
persistent objects. The client is given an object representation that contains
just a handle on a local object with a default persistence of 600 idle seconds.
Each operation on the object resets the idle timer to zero. This facility is
considered experimental in the current version of SOAP::Lite.</p>
</dd>
<dd>
<p>A global variable/``constant'' allows developers to specify the amount of time
an object will be persisted. The default value is 600 idle seconds. This value
can be changed using the following code:</p>
</dd>
<dd>
<pre>
  $SOAP::Constants::OBJS_BY_REF_KEEPALIVE = 1000;</pre>
</dd>
<dt><strong><a name="item_on_action">on_action(optional new value)</a></strong>

<dd>
<pre>
    $server-&gt;on_action(sub { ...new code });</pre>
</dd>
<dd>
<p>Gets or sets the reference to a subroutine that is used for executing the on_action hook. Where the client code uses this hook to construct the action-request data (such as for a SOAPAction header), the server uses the on_action hook to do any last-minute tests on the request itself, before it gets routed to a final destination. When called, the hook routine is passed three arguments:</p>
</dd>
<dl>
<dt><strong>action</strong>

<dd>
<p>The action URI itself, retrieved from the action method described earlier.</p>
</dd>
</li>
<dt><strong><a name="item_method_uri">method_uri</a></strong>

<dd>
<p>The URI of the XML namespace the method name is labeled with.</p>
</dd>
</li>
<dt><strong><a name="item_method_name">method_name</a></strong>

<dd>
<p>The name of the method being called by the request.</p>
</dd>
</li>
</dl>
<dt><strong><a name="item_on_dispatch">on_dispatch(optional new value)</a></strong>

<dd>
<pre>
    ($uri, $name) = $server-&gt;on_dispatch-&gt;($request);</pre>
</dd>
<dd>
<p>Gets or sets the subroutine reference used for the on_dispatch hook. This hook is called at the start of the request-routing phase and is given a single argument when called:</p>
</dd>
<dl>
<dt><strong><a name="item_request">request</a></strong>

<dd>
<p>An object of the <a href="../../../site/lib/SOAP/SOM.html">the SOAP::SOM manpage</a> class, containing the deserialized request from the client.</p>
</dd>
</li>
</dl>
<dt><strong><a name="item_find_target">find_target</a></strong>

<dd>
<pre>
    ($class, $uri, $name) = $server-&gt;find_target($req)</pre>
</dd>
<dd>
<p>Taking as its argument an object of the SOAP::SOM class that contains the deserialized request, this method returns a three-element list describing the method that is to be called. The elements are:</p>
</dd>
<dl>
<dt><strong><a name="item_class">class</a></strong>

<dd>
<p>The class into which the method call should be made. This may come back as either a string or an objectreference, if the dispatching is configured using an object instance.</p>
</dd>
</li>
<dt><strong><a name="item_uri">uri</a></strong>

<dd>
<p>The URN associated with the request method. This is the value that was used when configuring the method routing on the server object.</p>
</dd>
</li>
<dt><strong><a name="item_name">name</a></strong>

<dd>
<p>The name of the method to call.</p>
</dd>
</li>
</dl>
<dt><strong><a name="item_handle">handle</a></strong>

<dd>
<pre>
    $server-&gt;handle($request_text);</pre>
</dd>
<dd>
<p>Implements the main functionality of the serving process, in which the server takes an incoming request and dispatches it to the correct server-side subroutine. The parameter taken as input is either plain XML or MIME-encoded content (if MIME-encoding support is enabled).</p>
</dd>
<dt><strong><a name="item_make_fault">make_fault</a></strong>

<dd>
<pre>
    return $server-&gt;makefault($code, $message);</pre>
</dd>
<dd>
<p>Creates a SOAP::Fault object from the data passed in. The order of arguments is: code, message, detail, actor. The first two are required (because they must be present in all faults), but the last two may be omitted unless needed.</p>
</dd>
</dl>
<p>
</p>
<h2><a name="soap__server__parameters">SOAP::Server::Parameters</a></h2>
<p>This class provides two methods, but the primary purpose from the developer's point of view is to allow classes that a SOAP server exposes to inherit from it. When a class inherits from the SOAP::Server::Parameters class, the list of parameters passed to a called method includes the deserialized request in the form of a <a href="../../../site/lib/SOAP/SOM.html">the SOAP::SOM manpage</a> object. This parameter is passed at the end of the arguments list, giving methods the option of ignoring it unless it is needed.</p>
<p>The class provides two subroutines (not methods), for retrieving parameters from the <a href="../../../site/lib/SOAP/SOM.html">the SOAP::SOM manpage</a> object. These are designed to be called without an object reference in the parameter list, but with an array reference instead (as the first parameter). The remainder of the arguments list is expected to be the list from the method-call itself, including the SOAP::SOM object at the end of the list. The routines may be useful to understand if an application wishes to subclass SOAP::Server::Parameters and inherit from the new class instead.</p>
<dl>
<dt><strong><a name="item_bynameororder">byNameOrOrder(order, parameter list, envelope)</a></strong>

<dd>
<pre>
    @args = SOAP::Server::Parameters::byNameOrOrder ([qw(a b)], @_);</pre>
</dd>
<dd>
<p>Using the list of argument names passed in the initial argument as an array reference, this routine returns a list of the parameter values for the parameters matching those names, in that order. If none of the names given in the initial array-reference exist in the parameter list, the values are returned in the order in which they already appear within the list of parameters. In this case, the number of returned values may differ from the length of the requested-parameters list.</p>
</dd>
<dt><strong><a name="item_byname">byName(order, parameter list, envelope)</a></strong>

<dd>
<pre>
    @args = SOAP::Server::Parameters::byName ([qw(a b c)], @_);</pre>
</dd>
<dd>
<p>Acts in a similar manner to the previous, with the difference that it always returns as many values as requested, even if some (or all) don't exist. Parameters that don't exist in the parameter list are returned as undef values.</p>
</dd>
</dl>
<p>
</p>
<h3><a name="example">EXAMPLE</a></h3>
<p>The following is an example CGI based Web Service that utilizes a Perl module that inherits from the <code>SOAP::Server::Parameters</code> class. This allows the methods of that class to access its input by name.</p>
<pre>
    #!/usr/bin/perl
    use SOAP::Transport::HTTP;
    SOAP::Transport::HTTP::CGI
      -&gt;dispatch_to('C2FService')
      -&gt;handle;
    BEGIN {
      package C2FService;
      use vars qw(@ISA);
      @ISA = qw(Exporter SOAP::Server::Parameters);
      use SOAP::Lite;
      sub c2f {
        my $self = shift;
        my $envelope = pop;
        my $temp = $envelope-&gt;dataof(&quot;//c2f/temperature&quot;);
        return SOAP::Data-&gt;name('convertedTemp' =&gt; (((9/5)*($temp-&gt;value)) + 32));
      }
    }</pre>
<p>
</p>
<hr />
<h1><a name="see_also">SEE ALSO</a></h1>
<p><a href="../../../site/lib/SOAP/SOM.html">the SOAP::SOM manpage</a>, <a href="../../../site/lib/SOAP/Transport/HTTP.html">the SOAP::Transport::HTTP manpage</a></p>
<p>
</p>
<hr />
<h1><a name="acknowledgements">ACKNOWLEDGEMENTS</a></h1>
<p>Special thanks to O'Reilly publishing which has graciously allowed SOAP::Lite to republish and redistribute large excerpts from <em>Programming Web Services with Perl</em>, mainly the SOAP::Lite reference found in Appendix B.</p>
<p>
</p>
<hr />
<h1><a name="copyright">COPYRIGHT</a></h1>
<p>Copyright (C) 2000-2004 Paul Kulchenko. All rights reserved.</p>
<p>This library is free software; you can redistribute it and/or modify
it under the same terms as Perl itself.</p>
<p>
</p>
<hr />
<h1><a name="authors">AUTHORS</a></h1>
<p>Paul Kulchenko (<a href="mailto:paulclinger@yahoo.com">paulclinger@yahoo.com</a>)</p>
<p>Randy J. Ray (<a href="mailto:rjray@blackperl.com">rjray@blackperl.com</a>)</p>
<p>Byrne Reese (<a href="mailto:byrne@majordojo.com">byrne@majordojo.com</a>)</p>
<table border="0" width="100%" cellspacing="0" cellpadding="3">
<tr><td class="block" valign="middle">
<big><strong><span class="block">&nbsp;SOAP::Server - provides the basic framework for the transport-specific server classes to build upon</span></strong></big>
</td></tr>
</table>

</body>

</html>
