<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>SOAP::Packager - this class is an abstract class which allows for multiple types of packaging agents such as MIME and DIME.</title>
<link rel="stylesheet" href="../../../Active.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:root@localhost" />
</head>

<body>
<table border="0" width="100%" cellspacing="0" cellpadding="3">
<tr><td class="block" valign="middle">
<big><strong><span class="block">&nbsp;SOAP::Packager - this class is an abstract class which allows for multiple types of packaging agents such as MIME and DIME.</span></strong></big>
</td></tr>
</table>

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<li><a href="#methods">METHODS</a></li>
	<li><a href="#abstract_methods">ABSTRACT METHODS</a></li>
	<li><a href="#supported_packaging_formats">SUPPORTED PACKAGING FORMATS</a></li>
	<ul>

		<li><a href="#soap__packager__mime">SOAP::Packager::MIME</a></li>
		<ul>

			<li><a href="#mime_methods">MIME METHODS</a></li>
			<li><a href="#optimizing_the_mime_parser">OPTIMIZING THE MIME PARSER</a></li>
			<li><a href="#client_side_example">CLIENT SIDE EXAMPLE</a></li>
			<li><a href="#server_side_example">SERVER SIDE EXAMPLE</a></li>
		</ul>

		<li><a href="#soap__packager__dime">SOAP::Packager::DIME</a></li>
	</ul>

	<li><a href="#see_also">SEE ALSO</a></li>
	<li><a href="#copyright">COPYRIGHT</a></li>
	<li><a href="#authors">AUTHORS</a></li>
</ul>
<!-- INDEX END -->

<hr />
<p>
</p>
<hr />
<h1><a name="name">NAME</a></h1>
<p>SOAP::Packager - this class is an abstract class which allows for multiple types of packaging agents such as MIME and DIME.</p>
<p>
</p>
<hr />
<h1><a name="description">DESCRIPTION</a></h1>
<p>The SOAP::Packager class is responsible for managing a set of ``parts.'' Parts are
additional pieces of information, additional documents, or virtually anything that
needs to be associated with the SOAP Envelope/payload. The packager then will take
these parts and encode/decode or ``package''/``unpackage'' them as they come and go
over the wire.</p>
<p>
</p>
<hr />
<h1><a name="methods">METHODS</a></h1>
<dl>
<dt><strong><a name="item_new">new</a></strong>

<dd>
<p>Instantiates a new instance of a SOAP::Packager.</p>
</dd>
</li>
<dt><strong><a name="item_parts">parts</a></strong>

<dd>
<p>Contains an array of parts. The contents of this array and their types are completely
dependant upon the Packager being used. For example, when using MIME, the content
of this array is MIME::Entity's.</p>
</dd>
</li>
<dt><strong><a name="item_push_part">push_part</a></strong>

<dd>
<p>Adds a part to set of parts managed by the current instance of SOAP::Packager.</p>
</dd>
</li>
<dt><strong><a name="item_parser">parser</a></strong>

<dd>
<p>Returns the parser used to parse attachments out of a data stream.</p>
</dd>
</li>
<dt><strong><a name="item_headers_http">headers_http</a></strong>

<dd>
<p>This is a hook into the HTTP layer. It provides a way for a packager to add and/or modify
HTTP headers in a request/response. For example, most packaging layers will need to
override the Content-Type (e.g. multipart/related, or application/dime).</p>
</dd>
</li>
</dl>
<p>
</p>
<hr />
<h1><a name="abstract_methods">ABSTRACT METHODS</a></h1>
<p>If you wish to implement your own SOAP::Packager, then the methods below must be
implemented by you according to the prescribed input and output requirements.</p>
<dl>
<dt><strong><a name="item_package"><code>package()</code></a></strong>

<dd>
<p>The <a href="#item_package"><code>package</code></a> subroutine takes as input the SOAP envelope in string/SCALAR form.
This will serve as the content of the root part. The packager then encapsulates the
envelope with the parts contained within <a href="#item_parts"><code>parts</code></a> and returns the properly
encapsulated envelope in string/SCALAR form.</p>
</dd>
</li>
<dt><strong><a name="item_unpackage"><code>unpackage()</code></a></strong>

<dd>
<p>The <a href="#item_unpackage"><code>unpackage</code></a> subroutines takes as input raw data that needs to be parsed into
a set of parts. It is responsible for extracting the envelope from the input, and
populating <a href="#item_parts"><code>parts</code></a> with an ARRAY of parts extracted from the input. It then returns
the SOAP Envelope in string/SCALAR form so that SOAP::Lite can parse it.</p>
</dd>
</li>
</dl>
<p>
</p>
<hr />
<h1><a name="supported_packaging_formats">SUPPORTED PACKAGING FORMATS</a></h1>
<p>
</p>
<h2><a name="soap__packager__mime">SOAP::Packager::MIME</a></h2>
<p><code>SOAP::Packager::MIME</code> utilizes <a href="../../../site/lib/MIME/Tools.html">the MIME::Tools manpage</a> to provides the ability to send
and receive Multipart/Related and Multipart/Form-Data formatted requests and
responses.</p>
<p>
</p>
<h3><a name="mime_methods">MIME METHODS</a></h3>
<p>The following methods are used when composing a MIME formatted message.</p>
<dl>
<dt><strong><a name="item_transfer_encoding">transfer_encoding</a></strong>

<dd>
<p>The value of the root part's Content-Transfer-Encoding MIME Header. Default is: 8bit.</p>
</dd>
</li>
<dt><strong><a name="item_env_id">env_id</a></strong>

<dd>
<p>The value of the root part's Content-Id MIME Header. Default is: &lt;main_envelope&gt;.</p>
</dd>
</li>
<dt><strong><a name="item_env_location">env_location</a></strong>

<dd>
<p>The value of the root part's Content-Location MIME Header. Default is: /main_envelope.</p>
</dd>
</li>
<dt><strong><a name="item_env_type">env_type</a></strong>

<dd>
<p>The value of the root part's Content-Type MIME Header. Default is: text/xml.</p>
</dd>
</li>
</dl>
<p>
</p>
<h3><a name="optimizing_the_mime_parser">OPTIMIZING THE MIME PARSER</a></h3>
<p>The use of attachments can often result in a heavy drain on system resources depending
upon how your MIME parser is configured. For example, you can instruct the parser to
store attachments in memory, or to use temp files. Using one of the other can affect
performance, disk utilization, and/or reliability. Therefore you should consult the
following URL for optimization techniques and trade-offs:</p>
<p><a href="http://search.cpan.org/dist/MIME-tools/lib/MIME/Parser.pm#OPTIMIZING_YOUR_PARSER">http://search.cpan.org/dist/MIME-tools/lib/MIME/Parser.pm#OPTIMIZING_YOUR_PARSER</a></p>
<p>To modify the parser's configuration options consult the following code sample,
which incidentally shows how to minimize memory utilization:</p>
<pre>
  my $packager = SOAP::Packager::MIME-&gt;new;
  # $packager-&gt;parser-&gt;decode_headers(1); # no difference
  # $packager-&gt;parser-&gt;extract_nested_messages(1); # no difference
  $packager-&gt;parser-&gt;output_to_core(0); # much less memory
  $packager-&gt;parser-&gt;tmp_to_core(0); # much less memory
  $packager-&gt;parser-&gt;tmp_recycling(0); # promotes faster garbage collection
  $packager-&gt;parser-&gt;use_inner_files(1); # no difference
  my $client = SOAP::Lite-&gt;uri($NS)-&gt;proxy($URL)-&gt;packager($packager);
  $client-&gt;someMethod();</pre>
<p>
</p>
<h3><a name="client_side_example">CLIENT SIDE EXAMPLE</a></h3>
<p>The following code sample shows how to use attachments within the context of a
SOAP::Lite client.</p>
<pre>
  #!/usr/bin/perl
  use SOAP::Lite;
  use MIME::Entity;
  my $ent = build MIME::Entity
    Type        =&gt; &quot;text/plain&quot;,
    Path        =&gt; &quot;attachment.txt&quot;,
    Filename    =&gt; &quot;attachment.txt&quot;,
    Disposition =&gt; &quot;attachment&quot;;
  $NS = &quot;urn:Majordojo:TemperatureService&quot;;
  $HOST = &quot;<a href="http://localhost/cgi-bin/soaplite.cgi&quot">http://localhost/cgi-bin/soaplite.cgi&quot</a>;;
  my $client = SOAP::Lite
    -&gt;packager(SOAP::Packager::MIME-&gt;new)
    -&gt;parts([ $ent ])
    -&gt;uri($NS)
    -&gt;proxy($HOST);
  $response = $client-&gt;c2f(SOAP::Data-&gt;name(&quot;temperature&quot; =&gt; '100'));
  print $response-&gt;valueof('//c2fResponse/foo');</pre>
<p>
</p>
<h3><a name="server_side_example">SERVER SIDE EXAMPLE</a></h3>
<p>The following code shows how to use attachments within the context of a CGI
script. It shows how to read incoming attachments, and to return attachments to
the client.</p>
<pre>
  #!/usr/bin/perl -w
  use SOAP::Transport::HTTP;
  use MIME::Entity;
  SOAP::Transport::HTTP::CGI
    -&gt;packager(SOAP::Packager::MIME-&gt;new)
    -&gt;dispatch_with({'urn:Majordojo:TemperatureService' =&gt; 'TemperatureService'})
    -&gt;handle;</pre>
<pre>
  BEGIN {
    package TemperatureService;
    use vars qw(@ISA);
    @ISA = qw(Exporter SOAP::Server::Parameters);
    use SOAP::Lite;
    sub c2f {
      my $self = shift;
      my $envelope = pop;
      my $temp = $envelope-&gt;dataof(&quot;//c2f/temperature&quot;);
      use MIME::Entity;
      my $ent = build MIME::Entity
        Type        =&gt; &quot;text/plain&quot;,
        Path        =&gt; &quot;printenv&quot;,
        Filename    =&gt; &quot;printenv&quot;,
        Disposition =&gt; &quot;attachment&quot;;
      # read attachments                                                                                                         
      foreach my $part (@{$envelope-&gt;parts}) {
        print STDERR &quot;soaplite.cgi: attachment found! (&quot;.ref($part).&quot;)\n&quot;;
        print STDERR &quot;soaplite.cgi: contents =&gt; &quot;.$part-&gt;stringify.&quot;\n&quot;;
      }
      # send attachments                                                                                                         
      return SOAP::Data-&gt;name('convertedTemp' =&gt; (((9/5)*($temp-&gt;value)) + 32)),
        $ent;
    }
  }</pre>
<p>
</p>
<h2><a name="soap__packager__dime">SOAP::Packager::DIME</a></h2>
<p>TODO</p>
<p>
</p>
<hr />
<h1><a name="see_also">SEE ALSO</a></h1>
<p><a href="../../../site/lib/MIME/Tools.html">the MIME::Tools manpage</a>, <a href="../../../site/lib/DIME/Tools.html">the DIME::Tools manpage</a></p>
<p>
</p>
<hr />
<h1><a name="copyright">COPYRIGHT</a></h1>
<p>Copyright (C) 2000-2004 Paul Kulchenko. All rights reserved.</p>
<p>This library is free software; you can redistribute it and/or modify
it under the same terms as Perl itself.</p>
<p>
</p>
<hr />
<h1><a name="authors">AUTHORS</a></h1>
<p>Byrne Reese (<a href="mailto:byrne@majordojo.com">byrne@majordojo.com</a>)</p>
<table border="0" width="100%" cellspacing="0" cellpadding="3">
<tr><td class="block" valign="middle">
<big><strong><span class="block">&nbsp;SOAP::Packager - this class is an abstract class which allows for multiple types of packaging agents such as MIME and DIME.</span></strong></big>
</td></tr>
</table>

</body>

</html>
